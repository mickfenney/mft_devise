<div class="content round">
  <div class="row-fluid">
    <div class="span12">
      
      <%= render 'layouts/messages' %>

      <h3>Document Types</h3>

      <%= simple_form_for(:document_types, :url => document_types_path, :method => :get, :html => {:class => 'form-horizontal'}) do |f| %>
        <%= hidden_field_tag :direction, params[:direction] %>
        <%= hidden_field_tag :sort, params[:sort] %>
        <div class="form-inputs">
          <%= f.input :search, :wrapper => :prepend do %>
            <span class="add-on"><i class="icon-search"></i></span><%= text_field_tag :search, params[:search],  :placeholder => 'by name or desc' %>
          <% end %>
        </div>
        <div class="form-actions">
          <%= f.button :submit, "Search", :name => nil, :class => 'btn btn-primary' %>
        </div>  
        <% if current_user.has_role? :admin and params[:search] %>
          <div class='middle'> 
            <b><%= link_to 'Download CSV', document_types_document_types_path+'.csv?direction='+params[:direction]+'&sort='+params[:sort]+'&search='+params[:search] %></b>
          </div> 
        <% end %>         
      <% end %>
      
      <% if @document_types.any? %>
        <section id="no-more-tables"> 
          <table class="table table-striped table-bordered table-condensed up-down-arrow">
            <thead>
              <tr>
                <th><%= sortable "name" %></th>
                <th><%= sortable "description" %></th>
                <th></th>
                <th></th>
                <th><%= sortable "user_id", "User" %></th>
                <th><%= sortable "created_at", "Created" %></th>
              </tr>
            </thead>
            <tbody id="document_type_results">
              <%= render :partial => "document_type", :collection => @document_types %>
            </tbody>
          </table>  
        </section>
      <% end %> 

      <%= will_paginate @document_types %>

      <br />

      <%= link_to 'Create Document Type', new_document_type_path, :class => 'btn btn-primary btn-mini' %>  

      <hr>

      <!-- %= #link_to "Import Document Types", new_document_type_import_path % -->

      <h4>Import Document Types</h4>

      <p>A CSV file can be used to import records. The first row should be the column name. The following columns are allowed.</p>

      <ul>
        <% DocumentType.columns.each do |column| %>
          <% if column.name.in? ["id", *DocumentType.accessible_attributes] %>
            <li>
              <strong><%= column.name %></strong> -
              <%= column.type.to_s.titleize %> type
            </li>
          <% end %>
        <% end %>
      </ul>

      <p>If an <strong>id</strong> is supplied it will update the matching record instead of creating a new one.</p>


      <%= form_tag import_document_types_path, multipart: true do %>
        <%= file_field_tag :file %>
        <%= submit_tag "Import", :class => 'btn btn-primary btn-small' %>
      <% end %>

    </div>
  </div>
</div>

<script>
$("#dt_hint a").tooltip()
</script>
